<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>OKIENAK</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
:root{--p:#7A00FF;--l:#F0E6FF;--b:#F5F7FA;--t:#333;--e:#FF4D4F;--s:#28a745;}
*{box-sizing:border-box;margin:0;padding:0;font-family:'Poppins',sans-serif;}
html,body{min-height:100%;background:var(--b);display:flex;flex-direction:column;align-items:center;padding:20px 0;}
.container{width:95%;max-width:900px;background:#fff;border-radius:16px;padding:2rem;box-shadow:0 8px 30px rgba(0,0,0,.08);margin-bottom:20px;}
h1{text-align:center;color:var(--p);margin-bottom:1.5rem;font-weight:700;}
input,textarea,button,.tab button{width:100%;border-radius:10px;border:1px solid #e0e0e0;padding:.8rem;margin-bottom:1rem;font-size:1rem;font-weight:500;transition:all .2s ease;}
input:focus,textarea:focus{border-color:var(--p);box-shadow:0 0 0 2px var(--l);}
button{background:var(--p);color:#fff;cursor:pointer;border:none;font-weight:600;}
button:hover{filter:brightness(1.1);transform:translateY(-1px);}
.tab{display:flex;margin-bottom:1.5rem;border-radius:12px;background:var(--l);padding:5px;}
.tab button{flex:1;margin:0;background:transparent;color:var(--p);border:none;padding:.7rem;border-radius:8px;font-weight:600;}
.active-tab{background:var(--p)!important;color:#fff!important;font-weight:700!important;}
.hidden{display:none!important;}
.note-card{background:var(--l);border-radius:10px;padding:1.5rem;margin-bottom:1rem;box-shadow:0 2px 8px rgba(0,0,0,.05);}
.note-card p{font-weight:500;line-height:1.7;max-width:60ch;white-space:pre-wrap;word-wrap:break-word;margin-bottom:.75rem;}
.note-actions{display:flex;justify-content:flex-end;gap:8px;}
.note-actions button,.note-actions a{width:auto;padding:.5rem .9rem;margin-bottom:0;font-size:.85rem;border-radius:6px;font-weight:500;}
.btn-delete{background:var(--e);}
.btn-delete:hover{background:#c93030;}
a{color:var(--p);text-decoration:none;font-weight:500;}
footer{text-align:center;color:#888;margin-top:30px;font-size:.9rem;padding:0 20px;max-width:900px;width:95%;}
.youtube-links{margin-top:10px;display:flex;justify-content:center;gap:15px;font-weight:600;}
.youtube-links a{color:var(--e);transition:color .2s;}
.youtube-links a:hover{color:var(--p);}
</style>
</head>
<body>
<div class="container" id="aC">
    <h1>üîë OKIENAK</h1>
    <div class="tab">
        <button id="lT" class="active-tab">Masuk</button>
        <button id="rT">Daftar</button>
    </div>
    <div id="lF">
        <input id="lE" type="text" placeholder="Email">
        <input id="lP" type="password" placeholder="Password">
        <button id="lB">Masuk</button>
    </div>
    <div id="rF" class="hidden">
        <input id="rE" type="text" placeholder="Email">
        <input id="rP" type="password" placeholder="Password (Min. 3 karakter)">
        <input id="rCP" type="password" placeholder="Konfirmasi Password">
        <button id="rB">Daftar Akun</button>
    </div>
</div>
<div class="container hidden" id="nC">
    <h1>üìù Note by Okienak</h1>
    <p style="font-size:1.1rem;margin-bottom:1rem;font-weight:500;">Halo, <strong id="uN" style="color:var(--p);font-weight:700;"></strong></p>
    <textarea id="nI" placeholder="Tulis catatan baru di sini..."></textarea>
    <input id="nPI" type="password" placeholder="Password Opsional (untuk Share URL)">
    <button id="aNB">Tambah Catatan</button>
    <div id="nL" style="margin-top:1rem;"></div>
    <button id="lB2" class="btn-delete" style="margin-top:1rem;">Keluar</button>
</div>
<footer>
    ¬© 2024 OKIENAK | Kontak: <a href="mailto:cidmomo19@gmail.com">cidmomo19@gmail.com</a>
    <div class="youtube-links">
        <a href="https://www.youtube.com/@okiraenak" target="_blank">‚ñ∂Ô∏è Subscribe Okiraenak</a>
        <a href="https://www.youtube.com/@kaisarvidey" target="_blank">‚ñ∂Ô∏è Subscribe Kaisarvidey</a>
    </div>
</footer>
<script>
const D={aC:document.getElementById("aC"),nC:document.getElementById("nC"),lT:document.getElementById("lT"),rT:document.getElementById("rT"),lE:document.getElementById("lE"),lP:document.getElementById("lP"),lB:document.getElementById("lB"),rE:document.getElementById("rE"),rP:document.getElementById("rP"),rCP:document.getElementById("rCP"),rB:document.getElementById("rB"),uN:document.getElementById("uN"),nI:document.getElementById("nI"),nPI:document.getElementById("nPI"),aNB:document.getElementById("aNB"),nL:document.getElementById("nL"),lB2:document.getElementById("lB2"),lF:document.getElementById("lF"),rF:document.getElementById("rF")};
const gU=()=>JSON.parse(localStorage.getItem("users")||"{}");
const sU=u=>localStorage.setItem("users",JSON.stringify(u));
const gLUE=()=>localStorage.getItem("loggedIn");
const linkify=t=>{const p=/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig;return t.replace(p,'<a href="$1" target="_blank">$1</a>');}
const a=()=>{D.lT.classList.add("active-tab");D.rT.classList.remove("active-tab");D.lF.classList.remove("hidden");D.rF.classList.add("hidden");};
const b=()=>{D.rT.classList.add("active-tab");D.lT.classList.remove("active-tab");D.rF.classList.remove("hidden");D.lF.classList.add("hidden");};
D.lT.addEventListener("click",a);
D.rT.addEventListener("click",b);
D.rB.addEventListener("click",()=>{
    const e=D.rE.value.trim();const p=D.rP.value.trim();const cP=D.rCP.value.trim();
    if(!e||!p||!cP||p.length<3||p!==cP)return alert("Error: Email/password salah.");
    let u=gU();
    if(u[e])return alert("Error: Email sudah terdaftar!");
    u[e]={password:p,notes:[]};sU(u);alert("Daftar berhasil! Silakan masuk.");
    D.rE.value="";D.rP.value="";D.rCP.value="";a();
});
D.lB.addEventListener("click",()=>{
    const e=D.lE.value.trim();const p=D.lP.value.trim();let u=gU();
    if(u[e]&&u[e].password===p){localStorage.setItem("loggedIn",e);sNP(e);D.lE.value="";D.lP.value="";alert(`Selamat datang, ${e.split('@')[0]}!`);}
    else alert("Error: Email atau password salah!");
});
D.lB2.addEventListener("click",()=>{if(confirm("Yakin ingin keluar?")){localStorage.removeItem("loggedIn");location.reload();}});
function sNP(e){D.aC.classList.add("hidden");D.nC.classList.remove("hidden");D.uN.textContent=e.split('@')[0];rN();}
D.aNB.addEventListener("click",()=>{
    const t=D.nI.value.trim();const nP=D.nPI.value.trim();if(!t)return alert("Tulis catatan dulu!");
    const e=gLUE();let u=gU();
    u[e].notes.unshift({content:t,password:nP||null});sU(u);D.nI.value="";D.nPI.value="";rN();alert("Catatan berhasil ditambahkan!");
});
function dN(i){if(!confirm("Yakin hapus?"))return;const e=gLUE();let u=gU();u[e].notes.splice(i,1);sU(u);rN();alert("Catatan dihapus.");}
function rN(){
    D.nL.innerHTML="";const e=gLUE();let u=gU();
    if(!u[e]||!u[e].notes)return;let n=u[e].notes;
    if(n.length===0){D.nL.innerHTML=`<div style="text-align:center;padding:2rem;color:#888;border:2px dashed #ddd;border-radius:10px;"><h3>üëã Mulai Catatan Pertama Anda!</h3><p style="margin-top:.5rem;">Tulis sesuatu di atas.</p></div>`;return;}
    n.forEach((nO,i)=>{
        const isL=!!nO.password;const div=document.createElement("div");div.className="note-card";div.setAttribute('data-index',i);
        div.innerHTML=`
            <strong style="color:${isL?'var(--e)':'var(--p)'};font-weight:600;">${isL?'üîí Terkunci':'Biasa'}</strong>
            <p>${linkify(nO.content)}</p>
            <div class="note-actions">
                <a href="?n=${e}-${i}" target="_blank" style="background:#5a67d8;color:white;padding:.5rem .9rem;border-radius:6px;font-weight:500;">Bagikan</a>
                <button class="btn-delete" data-index="${i}">Hapus</button>
            </div>
        `;D.nL.appendChild(div);
    });
    D.nL.querySelectorAll(".btn-delete").forEach(btn=>btn.addEventListener("click",e=>dN(e.target.dataset.index)));
}
function rPN(nO,e){
    if(!nO||!('content'in nO))return D.nL.innerHTML=`<h2 style="color:var(--e);text-align:center;">Error: Catatan tidak valid.</h2>`;
    if(!!nO.password){
        D.nL.innerHTML=`
            <h2 style="color:var(--p);text-align:center;">üîí Catatan Terkunci</h2>
            <div class="note-card" style="background:white;border:1px solid var(--e);">
                <p style="text-align:center;">Dilindungi oleh ${e.split('@')[0]}.</p>
                <input type="password" id="sP" placeholder="Masukkan Kata Sandi Catatan">
                <button id="uB" style="margin-top:.5rem;">Buka Catatan</button>
            </div>
            <button id="cNR" style="margin-top:1rem;background:#5a67d8;">Buat Catatan Baru</button>
        `;
        document.getElementById('uB').addEventListener('click',()=>{
            const eP=document.getElementById('sP').value.trim();
            if(eP===nO.password)rC(nO.content,e,true);else alert("Kata sandi salah!");
        });
    }else rC(nO.content,e,true);
    if(document.getElementById('cNR'))document.getElementById('cNR').addEventListener('click',()=>window.location.href=window.location.origin+window.location.pathname);
}
function rC(c,e,sCB=false){
    D.nL.innerHTML=`
        <h2 style="color:var(--p);text-align:center;">Catatan Dibagikan</h2>
        <div class="note-card"><p>${linkify(c)}</p></div>
        <div style="text-align:center;font-size:.9rem;color:#888;"><p>Dibagikan oleh ${e.split('@')[0]}.</p></div>
    `;
    if(sCB){
         let cNR=document.getElementById('cNR');
         if(!cNR){
             D.nL.insertAdjacentHTML('afterend',`<button id="cNR" style="margin-top:1rem;background:#5a67d8;">Buat Catatan Baru</button>`);
             cNR=document.getElementById('cNR');
         }
         cNR.addEventListener('click',()=>window.location.href=window.location.origin+window.location.pathname);
    }
    document.querySelector('#nC h1').textContent="Catatan Publik";
}
window.addEventListener("load",()=>{
    const l=gLUE();const p=new URLSearchParams(window.location.search);const nP=p.get("n");
    if(nP){
        const[e,i]=nP.split("-");let u=gU();
        if(u[e]&&u[e].notes&&u[e].notes[i]){
            D.aC.classList.add("hidden");D.nC.classList.remove("hidden");
            document.querySelector('#nC p').style.display="none";D.nI.style.display="none";D.nPI.style.display="none";D.aNB.style.display="none";D.lB2.style.display="none";
            document.querySelector('#nC h1').textContent="Catatan Publik";rPN(u[e].notes[i],e);
        }else{alert("Error: Tautan catatan tidak valid.");D.aC.classList.remove("hidden");}
    }else if(l)sNP(l);else D.aC.classList.remove("hidden");
});
</script>
</body>
</html>
